# HadoopTP3
Spark assignment

In order to test our bundled jar, we run this command :
/usr/hdp/current/spark-client/bin/spark-submit --jars /home/parrie/TP3/spark-csv_2.10-1.3.0.jar,/home/parrie/TP3/commons-csv-1.2.jar /home/parrie/TP3/sparklab_2.10-1.0.jar

Our Jar is in target/scala-2.10/sparklab_2.10-1.0.jar

Request 1 :
The crime that happened the most in Sacremento during th month of January 20007 is: 10851(A)VC TAKE VEH W/O OWNER. It happened 653 times.

Request 2:
The 3 days when most crimes have happened are 11 (311 crimes), 18 (295 crimes), 17 (282 crimes)

Request 3:
Here are the average number of crime per each crime:
(503 PC   EMBEZZLEMENT,0.13333334)
(14601(A) VC LIC SUSP NEGLIGENT,0.033333335)
(INTOX REPORT/ADMIN PER - I RPT,0.033333335)
(4574(A)WEAPON/TEAR GAS IN JAIL,0.033333335)
(PERSON INFORMATION - I RPT,0.53333336)
(10.48.150 E FALSIFY PKG PERMIT,0.033333335)
(9.04.070 URINATE/DEFECATE PUB,0.033333335)
(1708 US   THEFT OF MAIL,0.6666667)
(290(A)(1)(D) FAIL TO REG-5 DAY,0.26666668)
(ROBBERY - I RPT,0.4)
(12.52.030 SCC UNLAWFUL CAMPING,0.23333333)
(12031(A)(1)PC LOADED GUN/PUB-M,0.033333335)
(13.10.200 SCC DUMP PUB PLACES,0.033333335)
(12303.3 PC FIRE BOMB INT INJ,0.033333335)
(COLLISION/ACCIDENT BOATS,0.033333335)
(484 PC   THEFT-LIC PLATE TABS,0.2)
(587C PC EVADE PAYMENT RAILFARE,0.033333335)
(DAMAGE - I RPT,0.033333335)
(211 PC ROBBERY-PURSE SNATCH,0.6666667)
(530 PC FALSE PERS. REC PROP,0.16666667)
(451(D) PC  ARSON OF PROPERTY,0.33333334)
(415.5(A)(1) PC FIGHT SCHOOL GR,0.033333335)
(368(E) THEFT OF ELDER <$400,0.06666667)
(417(A)2) PC BRANDISH FIREARM,0.16666667)
(836.6(B) PC ESCAPE FROM ARREST,0.033333335)
(FOUND PROPERTY - I RPT,2.7)
(CHILD CUSTODY - I RPT,0.33333334)
(11550(A)HS UNDER INFL NARCOTIC,0.13333334)
(459 PC  BURGLARY BUSINESS,4.5)
(240 PC ASSAULT/SIMPLE-CIVILIAN,0.1)
(WANTED SUBJ-O/S WANT/ I RPT,0.06666667)
(451(B) PC ARSON OF INHAB STRUC,0.1)
(484 PC-PETTY THEFT-COIN MACHIN,0.23333333)
(ELDER ABUSE/PHYS/MENTAL-I RPT,0.23333333)
(23103(A) RECKLESS ON HIGHWAY,0.26666668)
(647(F) PC PUB INTOX-DETOX ONLY,0.1)
(23153(A) VC DUI CAUSE INJURY,0.5)
(VANDALISM - I RPT,0.8)
(243(B) PC  BATTERY - OFFICER,0.033333335)
(498(B)(5) THEFT OF ELECTRICITY,0.033333335)
(12025(A)2)CONCL GUN ON PER/MSD,0.033333335)
(487(A) PC GRAND THEFT,2.8)
(11378 HS POSS CNTRL SUB/SALE,0.033333335)
(484 PETTY THEFT CLOUT UNLOCKED,0.6666667)
(243(E)1 BATTERY NONCOHAB SPOUS,2.7)
(459 PC  BURGLARY-UNSPECIFIED,0.4)
(666 PC PETTY THEFT W/PRI CONV,1.0)
(415(3) PC DIST PEACE OFF WORDS,0.06666667)
(243(D) PC BATT/CIVILIAN W/INJ,0.8666667)
(9.04.050C POSS OPEN CONTAINER,0.033333335)
(11378 HS POSS/SALE AMPHETAMINE,0.33333334)
(211 PC ROBBERY- BUSINESS,1.2666667)
(MISSING PERSON,8.933333)
(653.22(A) LOITER PROSTITUTION,0.4)
(601(A) WI JUVENILE INCORRIGIBL,0.06666667)
(245(C) AWDW/NO FIREARM/OFFICER,0.033333335)
(484E(A)PC THEFT OF CREDIT CARD,0.06666667)
(508 PC   EMBEZZLEMENT/EMPLOYEE,0.1)
(22435.2(A) BP POSS SHOP CART,0.23333333)
(TRAFFIC OFFENSE,0.1)
(FRAUD-SWINDLE,0.06666667)
(603  FORCED ENTRY/PROP DAMAGE,0.06666667)
(487(D)GRAND THEFT FIREARM/ANIM,0.26666668)
(THREATS - I RPT,2.3666666)
(11377(A)HS POSS AMPHETAMINES,1.9333333)
(1767.3 WI CYA PAROLE HOLD,0.033333335)
(SUSPICIOUS VEHICLE - I RPT,0.2)
(452(D)PC CAUSE FIRE OF PROPERT,0.033333335)
(487(D) PC GRAND THEFT AUTO,0.033333335)
(417.4 PC BRANDISH IMIT FIREARM,0.033333335)
(LOST PROPERTY-MATRICULA I RPT,0.033333335)
(626.2 PC UNAUTH ENTRY CAMPUS,0.033333335)
(12020(A)1) PROHIBITED FIREARM,0.33333334)
(TRAFFIC - I RPT,0.6666667)
(TRESPASS OR PROWLER- I RPT,0.2)
(368(C) CAUSE PAIN/INJ TO ELDER,0.033333335)
(203 PC    MAYHEM,0.033333335)
(9.40.020(A) JUVENILE CURFEW,0.1)
(12303.3 PC DEST DVC INTENT INJ,0.033333335)
(ACCIDENTAL FIRES/ARSON -I RPT,0.6666667)
(11366 HS MAINTN PLACE TO SELL,0.033333335)
(12671 HS SALE/POSS ILLGL FRWRK,0.033333335)
(602(K)TRESPASS:INJURE PROPERTY,0.13333334)
(484 PETTY THEFT/LICENSE PLATE,3.9666667)
(192(C)(2)VEH MAN W/O GROSS NEG,0.06666667)
(O/S AGENCY -ASSISTANCE- I RPT,0.43333334)
(459 PC  BURGLARY RESIDENCE,11.866667)
(SHOOT INTO OCCUP DWELL - I RPT,0.06666667)
(476 PC PASS FICTICIOUS CHECK,0.7)
(14601.1(A) VC LIC SUSP OTHER,0.2)
(BAIT CAR 10851 VC TAKE VEHICLE,0.033333335)
(11364 HS POSS DRUG PARAPH,3.3)
(241(B) ASSAULT ON POLICE OFFIC,0.033333335)
(242 PC  BATTERY CIVILIAN,2.9666667)
(415(1) PC DISTURB PEACE/FIGHT,0.3)
(20002(A) HIT/RUN,3.4333334)
(211 PC  ROBBERY-BANK,0.033333335)
(9.04.050 A DRINKING IN PUBLIC,0.3)
(20001(A) VC HIT/RUN INJ/DEATH,1.0)
(247(B) PC SHOOT UNOCC BLDG/VEH,0.16666667)
(LOST PROPERTY - I RPT,1.9)
(314.1 PC   INDECENT EXPOSURE,0.06666667)
(PETTY THEFT - I RPT,0.26666668)
(11357(C)HS POSS +28.5GR MARIJ,0.06666667)
(11360(A)HS SALE/TRANSP MARIJ,0.033333335)
(849(B)(1) CERTIFICATE OF RELEA,0.13333334)
(GRAND THEFT - I RPT,0.2)
(487(A) GRAND THEFT-INSIDE,1.3666667)
(FOUND EVIDENCE-NON NARC -I RPT,0.13333334)
(FORGERY-COUNTERFEITING,0.033333335)
(647(B) PC   PROSTITUTION,1.3)
(HAZARDOUS SITUATION - I RPT,0.06666667)
(FALSE PERSONATION - I RPT,0.033333335)
(DUI I RPT,0.033333335)
(23220 VC DRINKING WHILE DRVING,0.033333335)
(VICE/GAMBLING ACT - I RPT,0.033333335)
(594(B)(2)(A) VANDALISM/ -$400,6.5)
(23222(B)POSSESS MARIJ IN VEH,0.36666667)
(BATTERY - I RPT,1.1666666)
(POSSIBLE STOLEN PROPERTY-I RPT,0.16666667)
(290(F)1 W/I 5 DAYS ADD CHANGE,0.26666668)
(243.3 BATT TRANS PERS/PASS/INJ,0.033333335)
(496(A) PC REC STOLEN AUTO PART,0.033333335)
(484G(B) PC ACCESS CARD FRAUD,2.2)
(211 PC  ROBBERY UNSPECIFIED,3.3)
(602(L)(1)TRESPASS REFUSE TO LV,0.1)
(3056 PAROLE VIO - I RPT,0.9)
(594(B)(1)VANDALISM GRAF +$400,0.3)
(290(A)(1)(A) FAIL REG-CHG ADD,0.033333335)
(11377(A)HS POSS CNTRL SUBST,0.06666667)
(212.5(B) ROB-VICINITY OF ATM,0.033333335)
(459 PC  BURGLARY VEHICLE,15.4)
(SUSP PERS-NO CRIME - I RPT,1.4666667)
(TOWED/STORED VEHICLE,14.466666)
(31 VC FALSE INFO TO OFFICER,0.033333335)
(602(N)TRESP DRIVE ON PRIVATE P,0.033333335)
(NARCOTICS SUSP/EVID/ACT- I RPT,1.3666667)
(487(A) PC GRAND THEFT-SHOPLIFT,0.2)
(23152(A) VC DUI-ALCOHOL/DRUGS,2.8)
(368(B)(1) CRUELTY/ELDER/ W/INJ,0.033333335)
(HOMICIDE ASSAULT - I RPT,0.033333335)
(3056 PC PAROLE VIOLATION,0.16666667)
(12025(A)2)CNCLD GUN ON PER/FEL,0.06666667)
(TERRORIST THREATS - I RPT,0.1)
(246.3 PC NEGL DISCH FIREARM,0.06666667)
(484 PC   PETTY THEFT/INSIDE,3.3)
(422 PC THREAT/INTENT TO TERROR,0.6)
(243(C)(1)BATT EMERG PERSON-INJ,0.033333335)
(487(C) PC  GRAND THEFT-PERSON,0.13333334)
(602.1(A)TRES OBST BUSIN OPERAT,0.033333335)
(CAR CLOUT -  I RPT,0.06666667)
(ASSAULT WITH WEAPON - I RPT,0.53333336)
(IMPOUNDED VEHICLE,0.33333334)
(664/187(A) ATTEMPTED HOMICIDE,0.033333335)
(12101(B)1)PC MINOR POSS AMMO,0.033333335)
(11350(B)HS POSSESS QUAALUDES,0.3)
(484 PETTY THEFT-SHOPLIFT,2.8666666)
(243.6 BATTERY SCHOOL EMPLOYEE,0.13333334)
(FRAUDULENT DOCUMENTS- I RPT,0.1)
(148.9 PC FALSE ID TO OFFICER,0.43333334)
(11357(E) MNR POSS MARIJ SCHOOL,0.1)
(506 PC EMBEZZLEMENT/CONTRACTOR,0.033333335)
(12022.1 PC COMMIT FEL ON BAIL,0.1)
(5150 WI DANGER SELF/OTHERS,3.5333333)
(SAFEKEEPING - I RPT,0.46666667)
(HIT AND RUN /SUSPECTS- I RPT,0.23333333)
(MISCELLANEOUS I RPT (ZMISC),2.3666666)
(197 JUSTIFIABLE HOMI-CIVILIAN,0.033333335)
(21200.5 VC BICYCLE DUI,0.033333335)
(487(A) GRAND THEFT-AUTO PARTS,0.26666668)
(32 PC ACCESSORY TO A CRIME,0.033333335)
(ABC LICENSE VIO/INFO - I RPT,0.13333334)
(475(C) PASS FORGED NOTE,0.6666667)
(1203.2 PC VIOLATION OF PROBATI,0.4)
(12316(B)(1)FELON POSSESS AMMO,0.06666667)
(4462.5 VC FALSE TAB/AVOID REG,0.1)
(GRAFFITI PROBLEMS- I RPT,0.16666667)
(537(A)(1) DEFRAUD INKEEP/-$400,0.1)
(653K PC POSS/SELL SWITCHBLADE,0.1)
(12403.7(G) PC ILLGL POSS TRGAS,0.033333335)
(4140 BP  POSS OF HYPO NEEDLE,0.53333336)
(9.44.220 SCC ANIMAL AT LARGE,0.033333335)
(JUVENILE DISURBANCE - I RPT,0.23333333)
(530.5 PC USE PERSONAL ID INFO,2.1666667)
(12020(A)(4) PC DIRK/DAGGER,0.23333333)
(11357(B)HS POSS -28.5GR MARIJ,1.7)
(10851(A)VC TAKE VEH W/O OWNER,21.766666)
(647(F) PC DIP - DISORDERLY,0.8333333)
(529 PC FALSE PERSONATION,0.76666665)
(215(A) PC    CARJACKING,0.6)
(BURGLARY - I RPT,0.7)
(10852 VC VEHICLE TAMPERING,0.1)
(594(B)(2)(A)VANDALISM GRAF-400,0.73333335)
(11358 HS CULTIVATE MARIJUANA,0.033333335)
(485 PC PT OF FOUND PROPERTY,0.033333335)
(12420 PC SELL/TRANSP TEAR GAS,0.033333335)
(11532(A)HS LOITER DRG ACTIVITY,0.16666667)
(32210 EC WILFL DISTURB PUB SCH,0.033333335)
(11350(A)HS POSS CNTRL SUBST,1.4333333)
(4463(A)(1) VC ALTER REG,0.06666667)
(484J PC PUBLISH CARD INFO,0.7)
(653M(A) PC OBSCENE/THREAT CALL,0.56666666)
(10855 VC LSE/RENT NOT RETURNED,0.1)
(11379(A)HS SALE/TRAN CNTRL SUB,0.033333335)
(484G(A)PC USE FORGED CARD,0.2)
(212.5(A)ROBBERY-INHAB DWELLING,0.26666668)
(ABANDONED VEHICLE - I RPT,0.033333335)
(25662(A)BP POSS ALC BY MINOR,0.033333335)
(647(I) PEEPING TOM-INHAB DWELL,0.033333335)
(TOWED/STORED VEH-14602.6,15.433333)
(MISSING PERSON LOCATE O/S ASSI,0.43333334)
(647(A) PC LEWD CONDUCT,0.033333335)
(487(A) GRAND THEFT-CLOUT-UNLOC,0.36666667)
(496(A) RECEIVE STOLEN PROPERTY,0.8)
(290(G)(1) FAIL TO REG SEX OFFE,0.033333335)
(602.5 PC ENTRY OF PROPERTY,0.033333335)
(166(A)(4) WILFUL DISOBEY CT OR,0.33333334)
(PROB VIOLA/FEL-MISD - I RPT,0.23333333)
(1551(A) FUGITIVE FROM JUSTICE,0.43333334)
(25632 BP CONSM ALC AFT CLOSING,0.033333335)
(12025(B)6 UNREG/CONCLED FIREAR,0.033333335)
(NON INJ HR/MAIL OUT REPORT,3.0)
(23550.5 VC 4+DUI IN 10 YEARS,0.033333335)
(FRAUD OR BUNCO - I RPT,0.6333333)
(487(A) GRAND THEFT-COIN MACHIN,0.13333334)
(653M(B) PC ANNOY/RPT CALL HOME,0.4)
(187(A)  HOMICIDE,0.033333335)
(BOMBS/THREATS/EXPLOSIV- I RPT,0.13333334)
(JUVENILE OFFENDER-PROBATION,0.033333335)
(POSSIBLE MENTAL - I RPT,0.16666667)
(374.3(A) PC ILLEGAL DUMPING,0.033333335)
(WARRANT SERVED - I RPT,0.46666667)
(594.3(A)VANDAL/PLACE OF WORSHI,0.13333334)
(243(B) BATTERY DR/NURSE/EMERG,0.033333335)
(FILE-UNABLE TO DEFINE - I RPT,0.033333335)
(243.4(A) SEXUAL BATTERY,0.06666667)
(484 PETTY THEFT-PURSE SNATCH,0.06666667)
(23110(B) VC THROW AT VEH W/INT,0.033333335)
(484 PC  PETTY THEFT AUTO PART,0.13333334)
(NEIGHBORHOOD DISTURBANCE-I RPT,0.5)
(12500(A) VC UNLIC DRIVER,0.06666667)
(484E(D)PC FRAUD POSS CARD INFO,0.06666667)
(148.4(A)PC TAMPER FIRE PROT EQ,0.033333335)
(243.2(A)(1) BATT/SCHOOL INJURY,0.46666667)
(538D PC IMPERSON PEACE OFFICER,0.033333335)
(11351 HS POSS/SALE OPIATE/NARC,0.033333335)
(11352(B)HS TRANS SUBST TO CNTY,0.033333335)
(466 PC   POSS OF BURG TOOLS,0.2)
(JUVENILE PROBLEMS - I RPT,0.26666668)
(246 PC SHOOT OCCUP DWELL/VEH,0.56666666)
(278.5(A)DEPRIVE RIGHT OF CUSTO,0.033333335)
(POSSIBLE FINANCIAL CRIME-I RPT,0.46666667)
(374.4(A) LITTERING,0.06666667)
(308(B) PC MINOR POSS TOBACCO,0.2)
(245(A)(2) AWDW/FIREARM/CIVILIA,0.73333335)
(12.72.060I ADULT LOITER PLYGRD,0.033333335)
(484 PC PETTY THEFT,2.7333333)
(MISSING PERSON I RPT,0.8)
(CHILD WELFARE - I RPT,0.53333336)
(475(A)PC POSS FORGED CHK/NOTE,0.43333334)
(243.4(E)(1)TOUCH FOR SEX PLEAS,0.06666667)
(FORGERY-PASSING COUNTERFEIT,0.033333335)
(1705 US DESTRUCT OF MAIL RECEP,0.06666667)
(10851 VC AUTO THEFT LOCATE,7.4333334)
(11352(A)HS SALE/TRANS CNTL SUB,0.5)
(RECOVERED PROPERTY - I RPT,0.16666667)
(532 PC FRAUD OBTAIN MONEY ETC,0.13333334)
(RPT # CANCELLED- I RPT,0.06666667)
(10853 VC MALIC MISCHIEF TO VEH,0.06666667)
(TELEPEST -I RPT,0.56666666)
(POSS STOLEN VEHICLE- I RPT,0.16666667)
(273.6(A) PC VIO DV COURT ORDER,0.8333333)
(148(A)(1)PC RESIST PEACE OFFCR,0.33333334)
(23152(B) VC DUI BA .08 OR MORE,0.06666667)
(11351.5 HS POSS SALE RCK COCAI,0.26666668)
(PROTECTIVE CUSTODY-I RPT,0.3)
(11379(A)HS SELL/TRANSP AMPHET,0.06666667)
(5.136.050 NO TAXICAB PERMIT,0.033333335)
(2800.2(A) VC EVADING/RECKLESS,0.16666667)
(12025(A)1)CONCLD GUN VEH/FEL,0.033333335)
(FAMILY DISTURBANCE - I RPT,0.43333334)
(TRAFFIC-ACCIDENT INJURY,6.0666666)
(GANG ACTIVITY - I RPT,2.1666667)
(594(B)(1)PC  VANDALISM +$400,3.9)
(25661 BP FALSE EVIDENCE OF AGE,0.06666667)
(368(D) THEFT-ELDER >400,0.1)
(148.1(A)PC FALSE REPT OF BOMB,0.06666667)
(12022(A)(1)PC ARMED COMM FEL,0.033333335)
(99170 PUBLIC UTILITIES CODE,0.033333335)
(470 PC FORGERY,0.033333335)
(417(A)1) PC BRANDISH NON-GUN,0.26666668)
(245(A)(1)AWDW/NO FIREARM/CIVIL,2.5333333)
(243(C)2 PC BATT/PO WITH INJURY,0.033333335)
(BUSINESS PERMITS - I RPT,0.13333334)
(484 PC  PETTY THEFT/ OUTSIDE,1.6)
(136.1(C)(1) PC DISSUADE V/W,0.033333335)
(CASUALTY REPORT,3.8666666)
(TRAFFIC-ACCIDENT-NON INJURY,5.8333335)
(TRAFFIC ARREST FOR DA-I RPT,0.033333335)
(11359 HS POSS FOR SALE MARIJ,0.26666668)
(12021(A)(1)PC FELON POSS FRARM,0.26666668)
(HARASSMENT - I RPT,1.2)
(11361(B)HS ADLT FURN MNR MARIJ,0.033333335)
(626.10(A) PC POSS WPN SCHL ZN,0.13333334)

Part 2:
The average number of crime par day per district is:
1,28.0
2,47.16129032258065
3,50.806451612903224
4,37.45161290322581
5,37.38709677419355
6,43.83870967741935
